---
title: "Case_Study_datING"
date: "24 Ekim 2017"
output: html_document
---

```{r}

# First set your working directory
# setwd("C:\\Users\\serba\\Desktop\\Dersler\\R - Berk Orbay\\Week 3")
# # Download from GitHub (do it only once)
# download.file("https://mef-bda503.github.io/files/osym_data_2017.RData", 
#     "osym_data_2017.RData")
# # Install tidyverse if not already installed
# if (!("tidyverse" %in% installed.packages())) {
#     install.packages("tidyverse", repos = "https://cran.r-project.org")
# }
# # Load tidyverse package
```


```{r}

library(tidyverse)
# # Load the data
 load("osym_data_2017.RData")
# 
# 
# getwd()
# 
# options(dplyr.width=Inf)
# 
# 
# View(osym_data_2017.RData)
# library(dplyr)

```


###**Analysis of OSYM 2017 Data**

```{r}
#Filtered abroad university 
except_abroad <- osym_data_2017 %>% filter(program_id<300000000)


#Comparing Engineerin Faculties avarage of Min Scores of each program between MEF & The Other Universities 

mef_uni <- except_abroad %>% filter(university_name == "MEF ÃœNÄ°VERSÄ°TESÄ°")

mef_uni_muh <- mef_uni %>% filter(faculty_name == "MÃ¼hendislik FakÃ¼ltesi")

min(mef_uni_muh$min_score) 

max(mef_uni_muh$min_score)

other_uni_muh <-  except_abroad %>% filter(faculty_name == "MÃ¼hendislik FakÃ¼ltesi")

mean(mef_uni_muh$min_score)

mean(other_uni_muh$min_score)
```




```{r}
#Distinct faculties of all univerties
faculties <- except_abroad %>% distinct(university_name, faculty_name, .keep_all = TRUE)

#Distinct faculties of MEF univerties
mef_faculties <- mef_uni %>% distinct(university_name, faculty_name, .keep_all = TRUE)

#Mef total quota group by its faculties
mef_faculty_quota <- except_abroad %>% filter(university_name == "MEF ÃœNÄ°VERSÄ°TESÄ°") %>%  
  group_by(faculty_name) %>%  summarise(count=n(), total_quota = sum(general_quota))

# Total quota of Engineering Faculty of MEF
mef_uni_muh_quota <- mef_uni_muh %>%  summarise( count=n(), total_quota = sum(general_quota))

# All engineering faculties of univeresities in Ä°stanbul
total_uni_muh_ist <-  other_uni_muh %>% filter(city == "Ä°STANBUL")


#Average quota of Engineering Faculty of the other universites in Ä°stanbul
other_ist_muh_quota <- total_uni_muh_ist %>%  summarise( count=n(), total_quota = mean(general_quota))


# Quota of Engineering Faculty of the each universites in Ä°stanbul
total_eng_faculty_quota <- except_abroad %>% filter(city == "Ä°STANBUL" & faculty_name == "MÃ¼hendislik FakÃ¼ltesi") %>%  
  group_by(university_name, faculty_name) %>%  summarise(count_of_program_name=n(), total_quota = sum(general_quota))

```



```{r}
library(ggplot2)

ggplot(data=total_eng_faculty_quota, aes(x=university_name,y=total_quota, fill=time)) +
  geom_bar(colour="black", fill="#e67e22", width=.5, stat="identity") +
  guides(fill=FALSE) +
  xlab("University_Name") + ylab("Total_Quota") + 
  ggtitle("Quota of Engineering Faculty of the each universites in Ýstanbul")+
  theme(axis.text.x = element_text(angle=90, size=.8))

```




